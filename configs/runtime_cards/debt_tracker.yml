# Runtime Card: debt_tracker
# TASK-RC-010: Technical debt tracking
# Version: 1.0.0 (2026-01-31)

agent_id: "debt_tracker"
version: "1.0.0"

# Hierarchy
level: 4  # L4_Masters
reports_to: "qa_master"

# Core persona (3 campos usados pelo CrewAI)
role: "Debt Tracker"
goal: "Track, prioritize, and advocate for technical debt remediation"
backstory: |
  You are the Debt Tracker, responsible for maintaining visibility
  into the codebase's technical debt. You work with qa_master to
  ensure debt is properly catalogued, prioritized, and addressed
  in a timely manner.

  Your key responsibilities:
  - Identify and catalogue technical debt
  - Assess debt severity and interest rate
  - Prioritize debt for remediation
  - Track debt reduction over time
  - Advocate for debt paydown in sprints

  Debt should never grow faster than it's paid down.

# Key capabilities
key_skills:
  - "Debt identification and cataloging"
  - "Severity assessment"
  - "Interest rate calculation"
  - "Remediation prioritization"
  - "Debt trend analysis"

# Critical constraints
key_constraints:
  - "All debt must be catalogued with severity"
  - "Critical debt requires immediate escalation"
  - "Track debt-to-feature ratio per sprint"
  - "Never ignore security-related debt"
  - "Report debt trends to qa_master weekly"

pack_discovery:
  enabled: true
  before_action: "SEMPRE chame discover_packs() ANTES de executar qualquer tarefa"
  api_import: "from pipeline_autonomo.pack_discovery import discover_packs, load_pack"
  indices:
    - "docs/veritas_library/UNIFIED_PACK_INDEX.yaml"
  required_check: "Verificar se context pack foi carregado antes de agir"
  pat026_warning: "NUNCA execute sprint sem ler context pack"

# =============================================================================
# F4-001: SQUAD MEMORY INTEGRATION (2026-02-01)
# =============================================================================
squad_memory:
  enabled: true
  squad_id: "qa_squad"
  role: "worker"
  squad_lead: "qa_master"

  readable_segments:
    - "code_quality_patterns"
    - "common_bugs"
    - "review_feedback_patterns"

  submittable_findings:
    - "technical_debt"
    - "code_quality"

  awareness_prompt: |
    SQUAD MEMORY: Voce faz parte do qa_squad liderado por qa_master.
    Use os padroes de qualidade catalogados pelo squad para identificar debitos.
    Debitos tecnicos criticos serao enviados ao squad lead automaticamente.


# =============================================================================
# GRAPH STACKS INTEGRATION (2026-02-01)
# =============================================================================
# ALL 6 graph stacks configured for this agent with role-specific operations.
# Access via GraphStackOrchestrator with FAIL-CLOSED pattern.
graph_stacks:
  # FalkorDB - Knowledge graph for evidence and relationships
  falkordb_enabled: true
  falkordb_operations:
    - "traverse"
    - "execute_optimized"

  # Neo4j Enhanced - Vector search and GDS algorithms
  neo4j_enabled: true
  neo4j_operations:
    - "similarity_search"
    - "create_vector_index"

  # Neo4j Algorithms - PageRank, community detection, clustering
  neo4j_algorithms_enabled: true
  neo4j_algorithms_operations:
    - "run_pagerank"
    - "detect_communities"
    - "claim_clustering"

  # Neo4j Analytics - Advanced claim/source analysis
  neo4j_analytics_enabled: true
  neo4j_analytics_operations:
    - "trace_claim_propagation"

  # GoT Enhanced - Multi-path reasoning and thought graphs
  got_enabled: true
  got_operations:
    - "analyze_multi_perspective"
    - "build_reasoning_graph"
    - "aggregate_thoughts"

  # Graphiti - Temporal knowledge graph for facts over time
  graphiti_enabled: true
  graphiti_operations:
    - "ingest_episode"
    - "query_temporal"
    - "get_fact_history"
    - "invalidate_fact"

# =============================================================================
# RAG STACKS INTEGRATION (2026-02-01)
# =============================================================================
# RAG stacks for technical debt tracking and prioritization
rag_stacks:
  memo_rag:
    enabled: true
    priority: 1
    use_cases:
      - "Recall debt history and trends"
      - "Remember remediation outcomes"
      - "Track interest rate patterns"
    parameters:
      use_episodic_memory: true
      sprint_context: true

  graphrag:
    enabled: true
    priority: 2
    use_cases:
      - "Map debt dependencies"
      - "Understand impact propagation"
      - "Trace debt origins"
    parameters:
      include_reasoning_steps: true
      top_k: 8

  self_rag:
    enabled: true
    priority: 3
    use_cases:
      - "Retrieve debt assessment patterns"
      - "Find severity calibration examples"
      - "Query prioritization criteria"
    parameters:
      critique_response: true
      min_confidence: 0.7

  colbert:
    enabled: true
    priority: 4
    use_cases:
      - "Find specific code smells"
      - "Match debt signatures"
      - "Locate TODOs and FIXMEs"
    parameters:
      top_k: 10

  qdrant_hybrid:
    enabled: true
    priority: 5
    use_cases:
      - "Search debt documentation"
      - "General pattern search"
    parameters:
      collection_name: "tech_debt"
      top_k: 5

  corrective_rag:
    enabled: false
    reason: "Bug fixing delegated to auditor"

  raptor_rag:
    enabled: false
    reason: "Hierarchical docs not needed for debt tracking"

  awareness_prompt: |
    RAG STACKS: Voce tem acesso a 5 RAG stacks para rastreamento de debito tecnico.
    PRIORIDADE: MemoRAG > GraphRAG > Self-RAG > ColBERT > Qdrant
    Use MemoRAG para lembrar tendencias de debito ao longo do tempo.
    Use GraphRAG para entender como debito se propaga pelo codigo.
    DEBT TRACKER: debito NUNCA deve crescer mais rapido do que e pago.
